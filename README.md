TryHackMe: WebFortress-CTF Room - Official Write-Up

Introduction
Welcome to the official write-up for the WebFortress-CTF Room, a comprehensive journey through common web application vulnerabilities that demonstrates critical security flaws in real-world scenarios. This room provides hands-on experience with various attack vectors, from initial reconnaissance to privilege escalation, highlighting why proper input validation and access controls are essential for web application security. As we navigate through the WebFortress, we'll explore how seemingly minor oversights in development can lead to significant security breaches, emphasizing the importance of secure coding practices and thorough security testing in modern web applications.

Vulnerability Analysis and Exploitation
The initial phase of our assessment begins with basic reconnaissance through HTML source code analysis, where developers often inadvertently leave comments containing sensitive information or technical details that can provide attackers with valuable intelligence about the application's structure and potential attack surfaces. This fundamental step demonstrates why organizations should implement proper code review processes and use build tools to strip comments from production code.

Moving to authentication mechanisms, we encounter a critical SQL Injection vulnerability in the login form, where user input is directly concatenated into SQL queries without proper sanitization. The classic # admin' OR '1'='1 payload effectively bypasses authentication by manipulating the query logic, revealing how inadequate input validation can compromise entire authentication systems. This vulnerability underscores the necessity of using parameterized queries or prepared statements, implementing proper input validation, and applying the principle of least privilege for database accounts.

After gaining access, we discover an Insecure Direct Object Reference (IDOR) vulnerability that allows users to access data belonging to others by simply modifying URL parameters like user_id. This demonstrates how applications often fail to implement proper authorization checks, allowing horizontal privilege escalation where users can view unauthorized data. The vulnerability highlights the importance of implementing proper access control checks server-side for every request and using indirect object references instead of predictable, sequential IDs.

The assessment continues with Path Traversal vulnerabilities in the Document Manager functionality, where attackers can read arbitrary files outside the intended web directory using sequences like ../../../../etc/passwd. This flaw reveals how improper file path validation can lead to complete file system exposure, emphasizing the need for whitelist-based file access controls, proper input sanitization, and running web applications with minimal file system privileges.

We then identify a Cross-Site Scripting (XSS) vulnerability where user input is reflected back without proper encoding, allowing execution of malicious JavaScript through payloads like <script>alert(1)</script>. This client-side vulnerability demonstrates how inadequate output encoding can lead to session hijacking, unauthorized actions, and complete client-side compromise, necessitating proper context-aware output encoding and Content Security Policy implementations.

The final challenge involves privilege escalation to administrative access, requiring attackers to chain previously discovered vulnerabilities or find new attack vectors. This comprehensive attack chain demonstrates how individual vulnerabilities can combine to create severe security impacts, highlighting the importance of proper role-based access control, regular privilege escalation testing, and robust monitoring for unusual access patterns.

Additional Testing Areas
Beyond the primary vulnerabilities, the application contains additional areas like the Resource Search functionality and Document Manager that warrant thorough testing for XSS, SQL Injection, and information disclosure vulnerabilities. The administrator access requires specific interaction, prompting testers to look for hidden admin endpoints, commented-out functionality in page source, and use directory brute-forcing techniques to discover privileged administrative interfaces that may not be immediately visible through normal application usage.

Conclusion
The WebFortress-CTF room provides a realistic environment for understanding fundamental web application vulnerabilities and their exploitation techniques. Through this practical exercise, security professionals gain valuable insights into common security flaws, proper testing methodologies, and effective defense strategies. The room emphasizes that security is not a feature but a fundamental aspect of development that requires continuous attention, thorough testing, and defense-in-depth approaches. By understanding these vulnerabilities and their mitigations, developers and security practitioners can build more secure applications and better protect against real-world threats in an increasingly interconnected digital landscape.

